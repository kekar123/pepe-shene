<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫ ABC/XYZ</title>
    <link rel="stylesheet" href="gpt.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Segoe UI", Arial, sans-serif;
        }

        body {
            background: #f4f6fb;
            color: #1c1c1c;
        }

        /* HEADER */
        .header {
            width: 100%;
            background: linear-gradient(90deg, #0f1235, #1e2a5a);
        }

        .header-inner {
            max-width: 1300px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #fff;
        }

        .header-links a {
            color: #fff;
            margin-left: 20px;
            text-decoration: none;
            font-size: 20px;
        }

        /* MAIN */
        .result-container{
            max-width: 1300px;
            margin: 0px auto;
        }

        .page-container {
            max-width: 1300px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .info-btn {
            background: none;
            border: none;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
        }

        /* Upload */
        .upload-section {
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .upload-title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .tabs {
            display: flex;
            background-color: #a3c4e0;
            border-radius: 15px 15px 0 0;
            overflow: hidden;
        }
        
        .tab {
            flex: 1;
            padding: 10px 15px;
            text-align: center;
            cursor: pointer;
            background-color: #769CCE;
            transition: background-color 0.3s ease;
            font-size: 20px;
            font-weight: 700;
        }
        
        .tab.active {
            background-color: #d4e6f7;
            font-weight: 900;
            border-bottom: 3px  dashed #92b7e7;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background-color: #d4e6f7;
            border-radius: 0 0 15px 15px;
            min-height: 200px;
        }
        
        .tab-content.active {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .upload-button {
            background-color: #1a1a3a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 20px;
            margin-top: 50px;
            margin: 0 auto;
            display: flex;
            margin-top: 50px;
        }
        
        .upload-note {
            margin-top: 15px;
            font-size: 16px;
            color: #34495e;
            text-align: center;
        }

        /* Table */
        .table-container {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .table-tabs {
            display: flex;
        }
        
        .table-tab {
            padding: 10px 15px;
            cursor: pointer;
            white-space: nowrap;
            border-right: 1px solid rgba(255, 255, 255, 0.3);
            background-color: #7da8d6;
            font-size: 20px;
        }
        
        .table-tab:last-child {
            border-right: none;
            border-radius: 0px 8px 0px 0px;
        }
        
        .table-tab.active {
            background-color: #CBDEF3;
            font-weight: bold;
        }
        
        .table-wrapper {
            overflow: hidden;
            border-radius: 0px 8px 0px 0px;
            background-color: #d4e6f7;
            max-height: 300px;
            overflow-y: auto;
            overflow-x: auto;
        }

        .results-section {
            background: #121C32;
            padding: 30px;
            margin-bottom: 40px;
        }

        .results-section h2{
            color: #ffffff;
            text-align: center;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #b5d0e6;
            border-right: 1px solid #b5d0e6;
            font-size: 20px;
        }
        
        th {
            background-color: #CBDEF3;
            font-weight: bold;
        }
                
        tr:last-child td {
            border-bottom: none;
        }
                
        td:last-child {
            border-right: none;
        }

        /* Visualization */
        .visual-section {
            padding: 30px;
        }

        .visual-section  h2{
            color: #0f1235;
            margin-bottom: 20px;
            text-align: center;
        }

        .visual-section  h3{
            color: #0f1235;
            font-size: 20px;
        }

        .charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .chart-box {
            background: #dbe9f8;
            padding: 20px;
            border-radius: 12px;
        }

        .chart-placeholder {
            height: 220px;
            background: #bcd2ee;
            border-radius: 8px;
            margin-top: 15px;
        }

        .export-btn {
            margin: 30px auto 0;
            display: block;
            padding: 14px 30px;
            background: #0f1235;
            color: #fff;
            border: none;
            border-radius: 12px;
            font-size: 20px;
        }

        /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
        .info-toggle-btn {
            position: fixed;
            left: 0;
            top: 100px;
            background-color: #141232;
            color: white;
            border: 1px solid white;
            border-left: none;
            border-radius: 0 25px 25px 0;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            z-index: 1002;
            transition: all 0.3s ease;
            transform: translateX(-100%);
            opacity: 0.9;
        }

        .info-toggle-btn:hover {
            background-color: #141232;
            transform: translateX(0);
            opacity: 1;
        }

        .info-toggle-btn.visible {
            transform: translateX(0);
            background-color: #141232;
        }

        .btn-icon {
            font-size: 20px;
        }

        .btn-text {
            font-weight: 500;
            font-size: 16px;
        }

        /* –ü–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
        .info-panel {
            position: fixed;
            top: 0;
            left: -400px;
            width: 400px;
            height: 100vh;
            background-color: white;
            box-shadow: 5px 0 15px rgba(0,0,0,0.1);
            transition: left 0.3s ease;
            z-index: 1001;
            overflow-y: auto;
        }

        .info-panel.active {
            left: 0;
        }

        .info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: #141232;
            color: white;
            flex-direction: row-reverse;
        }

        .info-panel.active + .info-toggle-btn {
            left: 400px;
            transition: left 0.3s ease;
        }

        .info-header h2 {
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 30px;
            cursor: pointer;
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .info-content {
            padding: 20px;
        }

        .info-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #ecf0f1;
        }

        .info-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .info-section h4 {
            color: #34495e;
            margin: 15px 0 10px;
        }

        .info-section ul {
            list-style-position: inside;
            margin-left: 20px;
        }

        .info-section li {
            margin-bottom: 8px;
        }

        .product-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 10px 0 20px;
        }

        .product-item {
            background-color: #ecf0f1;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
        }

        .recommendation {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid;
        }

        .recommendation .category-a {
            color: #42e73c;
            border-left-color: #42e73c;
        }

        .recommendation .category-b {
            color: #f39c12;
            border-left-color: #f39c12;
        }

        .recommendation .category-c {
            color: #f53b35;
            border-left-color: #f53b35;
        }

        .recommendation p {
            margin-bottom: 8px;
        }

        /*–ë–û–û–û–û–û–û–û–û–¢*/
        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–∞—Ç-–±–æ—Ç–∞ */
        .chat-bot-btn {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #121C32;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1004;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .chat-bot-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .bot-avatar {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* –û–∫–Ω–æ —á–∞—Ç–∞ */
        .chat-window {
            position: fixed;
            right: -400px;
            bottom: 90px;
            width: 380px;
            height: 600px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.15);
            z-index: 1003;
            display: flex;
            flex-direction: column;
            transition: right 0.3s ease;
            overflow: hidden;
        }

        .chat-window.active {
            right: 20px;
        }

        .chat-header {
            background-color: #0f1235;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .bot-avatar-small {
            font-size: 24px;
            background: rgba(255,255,255,0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 500;
        }

        .chat-close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            line-height: 1;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }

        .chat-close-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        /* –¢–µ–ª–æ —á–∞—Ç–∞ */
        .chat-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #f8f9fa;
        }

        .welcome-message {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-left: 4px solid #3498db;
        }

        .welcome-message p {
            margin: 0;
            color: #2c3e50;
            line-height: 1.5;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .chat-messages {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .user-message {
            background: #3498db;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .bot-message {
            background: white;
            color: #2c3e50;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */
        .chat-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border 0.3s;
        }

        .chat-input:focus {
            border-color: #2980b9;
        }

        .send-btn {
            padding: 12px 24px;
            background: #314674;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }

        .send-btn:hover {
            background: #2980b9;
        }

        /* –ö–æ–≥–¥–∞ –æ–±–µ –ø–∞–Ω–µ–ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã */
        .info-panel.active ~ .main-content {
            margin-left: 400px;
            transition: margin-left 0.3s ease;
        }

        .info-panel.active ~ .info-toggle-btn {
            left: 400px;
            transition: left 0.3s ease;
        }

        /* –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞ –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –ø–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
        .info-panel.active ~ .chat-bot-btn {
            right: 20px;
            bottom: 20px;
        }

        /* –û–∫–Ω–æ —á–∞—Ç–∞ –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –ø–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
        .info-panel.active ~ .chat-window.active {
            right: 20px;
            bottom: 90px;
        }

        /* –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞ –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç–æ –æ–∫–Ω–æ —á–∞—Ç–∞ (–±–µ–∑ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏) */
        .chat-window.active ~ .chat-bot-btn {
            right: 420px;
            transition: right 0.3s ease;
        }

        /* –ö–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç—ã –æ–±–µ –ø–∞–Ω–µ–ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ */
        .info-panel.active ~ .chat-window.active ~ .chat-bot-btn {
            right: 420px;
            transition: right 0.3s ease;
        }

        /* FOOTER */
        .footer {
            width: 100%;
            background: #0f1235;
            color: #fff;
            margin-top: 60px;
        }

        .footer-inner {
            max-width: 1300px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }

        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –∑–∞–≥—Ä—É–∑–∫–∏ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 10000;
            display: none;
            max-width: 400px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .notification.success {
            background-color: #4CAF50;
            color: white;
            display: block;
        }
        
        .notification.error {
            background-color: #f44336;
            color: white;
            display: block;
        }
        
        .notification.info {
            background-color: #2196F3;
            color: white;
            display: block;
        }
        
        .close-notification {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            float: right;
            font-size: 20px;
            margin-left: 10px;
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background-color: #e0e0e0;
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
            display: none;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .upload-area {
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-area.dragover {
            background-color: rgba(30, 42, 90, 0.15);
            border-color: #4CAF50;
            transform: scale(1.01);
        }
        
        .upload-icon {
            font-size: 48px;
            color: #1e2a5a;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 16px;
            color: #333;
            margin-bottom: 10px;
        }
        
        .upload-note {
            font-size: 14px;
            color: #666;
            margin-top: 15px;
        }
        
        .file-input {
            display: none;
        }
        
        .upload-button {
            background-color: #1a1a3a;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .upload-button:hover {
            background-color: #0f1235;
            transform: translateY(-2px);
        }
        
        .upload-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .category-a {
            color: #42e73c;
            font-weight: bold;
        }
        
        .category-b {
            color: #f39c12;
            font-weight: bold;
        }
        
        .category-c {
            color: #f53b35;
            font-weight: bold;
        }
        
        .simple-chart {
            padding: 10px;
        }
        
        .chart-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .chart-label {
            width: 30px;
            font-weight: bold;
        }
        
        .chart-bar-container {
            flex: 1;
            height: 20px;
            background-color: #f0f0f0;
            margin: 0 10px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .chart-bar {
            height: 100%;
            transition: width 1s ease-in-out;
        }
        
        .chart-value {
            width: 100px;
            text-align: right;
            font-size: 14px;
        }
        
        .analysis-stats {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #1e2a5a;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        
        .stat-item {
            background: white;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #0f1235;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø–µ—á–∞—Ç–∏ */
        .typing-indicator {
            padding: 10px 15px;
        }

        .typing-dots {
            display: flex;
            align-items: center;
            height: 20px;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            margin: 0 2px;
            background-color: #95a5a6;
            border-radius: 50%;
            display: inline-block;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .message-time {
            font-size: 11px;
            color: #95a5a6;
            margin-top: 4px;
            text-align: right;
        }
    </style>
</head>
<body>

<!-- HEADER -->
<header class="header">
    <div class="header-inner">
        <h1>–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫ ABC/XYZ</h1>
        <nav class="header-links">
            <a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
            <a href="#">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
        </nav>
    </div>
</header>

<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div id="notification" class="notification">
    <span id="notification-text"></span>
    <button class="close-notification" onclick="hideNotification()">√ó</button>
    <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
    </div>
</div>

<!-- MAIN CONTENT -->
<main class="page-container">
    <!-- Upload -->
    <div class="container">
        <div class="upload-section">
            <div class="upload-title">–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>
            
            <div class="tabs">
                <div class="tab active" data-tab="upload">ABC/XYZ –ê–Ω–∞–ª–∏–∑</div>
                <div class="tab" data-tab="download">–û—Ç–≥—Ä—É–∑–∫–∞</div>
            </div>
            
            <div class="tab-content active" id="upload">
                <div class="upload-area" id="dropArea">
                    <div class="upload-icon">üìä</div>
                    <div class="upload-text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ Excel —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
                    <input type="file" id="fileInput" class="file-input" accept=".xls,.xlsx">
                    <button class="upload-button" onclick="document.getElementById('fileInput').click()">
                        –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
                    </button>
                    <div class="upload-note">
                        <strong>–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:</strong> .xls –∏–ª–∏ .xlsx<br>
                        <strong>–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:</strong> "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞", "–í—ã—Ä—É—á–∫–∞ (–£.–ï.)", –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º
                    </div>
                </div>
                
                <div class="analysis-stats" id="analysisStats" style="display: none;">
                    <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞:</h4>
                    <div id="statsDetails"></div>
                </div>
            </div>
            
            <div class="tab-content" id="download">
                <p style="text-align: center; padding: 20px;">–§—É–Ω–∫—Ü–∏—è –æ—Ç–≥—Ä—É–∑–∫–∏ –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "–ê–Ω–∞–ª–∏–∑".</p>
            </div>
        </div>
    </div>
</main>

<!-- Table -->
<section class="results-section">
    <main class="result-container">
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h2>
        
        <div class="table-container">
            <div class="table-tabs">
                <div class="table-tab active">–û–±—â–µ–µ</div>
                <div class="table-tab">ABC –∞–Ω–∞–ª–∏–∑</div>
                <div class="table-tab">XYZ –∞–Ω–∞–ª–∏–∑</div>
                <div class="table-tab">–ú–∞—Ç—Ä–∏—Ü–∞</div>
            </div>

            <div class="table-wrapper">
                <table id="analysisTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</th>
                            <th>–í—ã—Ä—É—á–∫–∞ (–£.–ï.)</th>
                            <th>ABC –∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                            <th>XYZ –∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                            <th>ABC-XYZ –º–∞—Ç—Ä–∏—Ü–∞</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px;">
                                –ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</section>

<!-- Visualization -->
<main class="page-container">
    <section class="visual-section">
        <h2>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h2>

        <div class="charts">
            <div class="chart-box">
                <h3>–î–æ–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π ABC</h3>
                <div class="chart-placeholder" id="abcChart"></div>
            </div>

            <div class="chart-box">
                <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º XYZ</h3>
                <div class="chart-placeholder" id="xyzChart"></div>
            </div>
        </div>
    </section>
</main>

<!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
<button class="info-toggle-btn" onclick="toggleInfoPanel()">
    <span class="btn-text">–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</span>
</button>

<!-- –í—ã–¥–≤–∏–∂–Ω–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
<div class="info-panel" id="infoPanel">
    <div class="info-header">
        <button class="close-btn" onclick="toggleInfoPanel()">√ó</button>
        <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
    </div>
    
    <div class="info-content">
        <div class="info-section">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∞–Ω–∞–ª–∏–∑—É</h3>
            <div id="dynamicAnalysisInfo">
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–Ω–∞–ª–∏–∑–µ</p>
            </div>
        </div>

        <div class="info-section">
            <h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ª–æ–≥–∏—Å—Ç–∏–∫–µ</h3>
            
            <div class="recommendation">
                <h4 class="category-a">–ö–∞—Ç–µ–≥–æ—Ä–∏—è A (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–æ–Ω–∞):</h4>
                <p>–†–∞–∑–º–µ—â–µ–Ω–∏–µ: –≤ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ –∫ –∑–æ–Ω–µ –æ—Ç–≥—Ä—É–∑–∫–∏ (–Ω–µ –¥–∞–ª–µ–µ 10-15 –º–µ—Ç—Ä–æ–≤).</p>
                <p>–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è: –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø "–∑–æ–ª–æ—Ç–æ–π –∑–æ–Ω—ã" - —É—Ä–æ–≤–µ–Ω—å –æ—Ç –ø–æ–ª–∞ 0,8-1,6 –º.</p>
                <p>–ó–∞–ø–∞—Å—ã: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å (30-40 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è).</p>
                <p>–ß–∞—Å—Ç–æ—Ç–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –º–µ—Ç–æ–¥ —Å–∫–ª–∞–¥–∏—Ä–æ–≤–∞–Ω–∏—è: –∞–¥—Ä–µ—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.</p>
            </div>

            <div class="recommendation">
                <h4 class="category-b">–ö–∞—Ç–µ–≥–æ—Ä–∏—è B (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –∑–æ–Ω–∞):</h4>
                <p>–†–∞–∑–º–µ—â–µ–Ω–∏–µ: —Å—Ä–µ–¥–Ω—è—è –∑–æ–Ω–∞ —Å–∫–ª–∞–¥–∞ (15-30 –º–µ—Ç—Ä–æ–≤ –æ—Ç –∑–æ–Ω—ã –æ—Ç–≥—Ä—É–∑–∫–∏).</p>
                <p>–ó–∞–ø–∞—Å—ã: –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å (15-20 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è).</p>
                <p>–ß–∞—Å—Ç–æ—Ç–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏: —Ä–∞–∑ –≤ 2 –Ω–µ–¥–µ–ª–∏.</p>
                <p>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –º–µ—Ç–æ–¥ —Å–∫–ª–∞–¥–∏—Ä–æ–≤–∞–Ω–∏—è: –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ.</p>
            </div>

            <div class="recommendation">
                <h4 class="category-c">–ö–∞—Ç–µ–≥–æ—Ä–∏—è C (—É–¥–∞–ª—ë–Ω–Ω–∞—è –∑–æ–Ω–∞):</h4>
                <p>–†–∞–∑–º–µ—â–µ–Ω–∏–µ: –≤ –≥–ª—É–±–∏–Ω–µ —Å–∫–ª–∞–¥—Å–∫–æ–π –∑–æ–Ω—ã (–¥–∞–ª–µ–µ 30 –º–µ—Ç—Ä–æ–≤ –æ—Ç –∑–æ–Ω—ã –æ—Ç–≥—Ä—É–∑–∫–∏).</p>
                <p>–°—Ç—Ä–∞—Ç–µ–≥–∏—è: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–ª–∞–¥—Å–∫–∏—Ö –∑–∞–ø–∞—Å–æ–≤.</p>
                <p>–ó–∞–ø–∞—Å—ã: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å (7-10 –¥–Ω–µ–π) –∏–ª–∏ —Ä–∞–±–æ—Ç–∞ –ø–æ–¥ –∑–∞–∫–∞–∑.</p>
                <p>–ß–∞—Å—Ç–æ—Ç–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏: –µ–∂–µ–º–µ—Å—è—á–Ω–∞—è.</p>
                <p>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞.</p>
            </div>
        </div>

        <div class="info-section">
            <h3>–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h3>
            <ul>
                <li>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏ —Å —É—á—ë—Ç–æ–º ABC-–∑–æ–Ω.</li>
                <li>–í–Ω–µ–¥—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É WMS –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è.</li>
                <li>–ü—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—É—é —Ä–æ—Ç–∞—Ü–∏—é —Ç–æ–≤–∞—Ä–æ–≤ –º–µ–∂–¥—É –∑–æ–Ω–∞–º–∏ (–µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ).</li>
            </ul>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer class="footer">
    <div class="footer-inner">
        ¬©2025 –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫ ABC/XYZ | –ü—Ä–æ–µ–∫—Ç –ù–æ–≥–∏–Ω—Å–∫–æ–≥–æ –∫–æ–ª–ª–µ–¥–∂–∞
    </div>
</footer>

<!-- –ß–∞—Ç-–±–æ—Ç –∫–Ω–æ–ø–∫–∞ -->
<button class="chat-bot-btn" onclick="toggleChat()">
    <div class="bot-avatar">ü§ñ</div>
</button>

<!-- –û–∫–Ω–æ —á–∞—Ç-–±–æ—Ç–∞ -->
<div class="chat-window" id="chatWindow">
    <div class="chat-header">
        <div class="chat-title">
            <div class="bot-avatar-small">ü§ñ</div>
            <h3>–ó–∞–¥–∞–π—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å</h3>
        </div>
        <button class="chat-close-btn" onclick="toggleChat()">√ó</button>
    </div>
    
    <div class="chat-body">
        <div class="welcome-message">
            <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ú–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å –ª—é–±–æ–π –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –í–∞—Å –≤–æ–ø—Ä–æ—Å –ø–æ –∞–Ω–∞–ª–∏–∑—É –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –í–∞–º –ø–æ–º–æ—á—å!</p>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
    </div>
    
    <div class="chat-input-area">
        <input type="text" 
               class="chat-input" 
               id="chatInput" 
               placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
               onkeypress="handleKeyPress(event)">
        <button class="send-btn" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
</div>

<script>
    // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
    const API_BASE_URL = 'http://localhost:5000';
    
    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');
    const notification = document.getElementById('notification');
    const notificationText = document.getElementById('notification-text');
    const progressFill = document.getElementById('progress-fill');
    const tableBody = document.getElementById('tableBody');
    const dynamicAnalysisInfo = document.getElementById('dynamicAnalysisInfo');
    const abcChart = document.getElementById('abcChart');
    const xyzChart = document.getElementById('xyzChart');
    const analysisStats = document.getElementById('analysisStats');
    const statsDetails = document.getElementById('statsDetails');
    
    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    let currentAnalysisData = null;
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', function() {
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ drag and drop
        setupDragAndDrop();
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
        setupFileInput();
        
        // –î–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤–∏–¥–∏–º–æ–π —Å—Ä–∞–∑—É
        const toggleBtn = document.querySelector('.info-toggle-btn');
        toggleBtn.classList.add('visible');
    });
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ drag and drop
    function setupDragAndDrop() {
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            dropArea.classList.add('dragover');
        }
        
        function unhighlight() {
            dropArea.classList.remove('dragover');
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ drop
        dropArea.addEventListener('drop', handleDrop, false);
    }
    
    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        
        if (files.length > 0) {
            processFile(files[0]);
        }
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
    function setupFileInput() {
        fileInput.addEventListener('change', function(e) {
            if (this.files.length > 0) {
                processFile(this.files[0]);
            }
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞
    function processFile(file) {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞
        const validExtensions = ['.xls', '.xlsx'];
        const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
        
        if (!validExtensions.includes(fileExtension)) {
            showNotification('–û—à–∏–±–∫–∞: —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã Excel (.xls, .xlsx)', 'error');
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 10 –ú–ë)
        const maxSize = 10 * 1024 * 1024; // 10 –ú–ë
        if (file.size > maxSize) {
            showNotification('–û—à–∏–±–∫–∞: —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 10 –ú–ë', 'error');
            return;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
        showNotification(`–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞: ${file.name}`, 'info');
        updateProgress(30);
        
        // –°–æ–∑–¥–∞–µ–º FormData
        const formData = new FormData();
        formData.append('file', file);
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        uploadFile(formData);
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    async function uploadFile(formData) {
        try {
            updateProgress(50);
            
            const response = await fetch(`${API_BASE_URL}/upload`, {
                method: 'POST',
                body: formData
            });
            
            updateProgress(80);
            
            const result = await response.json();
            
            if (response.ok && result.success) {
                // –£—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
                updateProgress(100);
                showNotification(result.message, 'success');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏–∑–∞
                currentAnalysisData = result;
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                displayAnalysisStats(result);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏–∑–∞
                await loadAnalysisData(result.download_links.analysis);
            } else {
                // –û—à–∏–±–∫–∞
                showNotification(result.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞', 'error');
                updateProgress(0);
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
            showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
            updateProgress(0);
        }
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–Ω–∞–ª–∏–∑–∞
    function displayAnalysisStats(data) {
        analysisStats.style.display = 'block';
        
        const abcStats = data.stats.abc_distribution;
        const xyzStats = data.stats.xyz_distribution;
        
        statsDetails.innerHTML = `
            <p><strong>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤:</strong> ${data.stats.total_items}</p>
            <div class="stats-grid">
                ${Object.entries(abcStats).map(([category, count]) => `
                    <div class="stat-item">
                        <div class="stat-value">${count}</div>
                        <div class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è ${category}</div>
                    </div>
                `).join('')}
                
                ${Object.entries(xyzStats).map(([category, count]) => `
                    <div class="stat-item">
                        <div class="stat-value">${count}</div>
                        <div class="stat-label">XYZ ${category}</div>
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–∞
    async function loadAnalysisData(analysisUrl) {
        try {
            showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–∞...', 'info');
            
            const response = await fetch(`${API_BASE_URL}${analysisUrl}`);
            const analysisData = await response.json();
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ
            displayAnalysisTable(analysisData);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ø–∞–Ω–µ–ª–∏
            updateAnalysisInfo(analysisData);
            
            // –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
            createCharts(analysisData);
            
            showNotification('–ê–Ω–∞–ª–∏–∑ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!', 'success');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∞–ª–∏–∑–∞:', error);
            showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–∞', 'error');
        }
    }
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∞–Ω–∞–ª–∏–∑–∞
    function displayAnalysisTable(data) {
        tableBody.innerHTML = '';
        
        if (data.length === 0) {
            tableBody.innerHTML = `
                <tr>
                    <td colspan="6" style="text-align: center; padding: 40px;">
                        –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    </td>
                </tr>
            `;
            return;
        }
        
        data.forEach(item => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${item.id || ''}</td>
                <td>${item.name || ''}</td>
                <td>${item.revenue || 0}</td>
                <td><span class="category-${item.ABC?.toLowerCase()}">${item.ABC || ''}</span></td>
                <td>${item.XYZ || ''}</td>
                <td>${item.ABC_XYZ || ''}</td>
            `;
            tableBody.appendChild(row);
        });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –ø–∞–Ω–µ–ª–∏
    function updateAnalysisInfo(data) {
        // –ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        const abcCounts = { A: 0, B: 0, C: 0 };
        const xyzCounts = { X: 0, Y: 0, Z: 0 };
        
        data.forEach(item => {
            if (abcCounts.hasOwnProperty(item.ABC)) {
                abcCounts[item.ABC]++;
            }
            if (xyzCounts.hasOwnProperty(item.XYZ)) {
                xyzCounts[item.XYZ]++;
            }
        });
        
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∞–º—ã—Ö –≤—ã—Å–æ–∫–æ- –∏ –Ω–∏–∑–∫–æ—Ö–æ–¥–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
        const sortedByRevenue = [...data].sort((a, b) => b.revenue - a.revenue);
        const topProducts = sortedByRevenue.slice(0, 3).map(item => item.name);
        const bottomProducts = sortedByRevenue.slice(-3).map(item => item.name);
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
        dynamicAnalysisInfo.innerHTML = `
            <h4>–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ABC:</h4>
            <ul>
                <li>A (–≤—ã—Å–æ–∫–æ–æ–±–æ—Ä–æ—Ç–Ω—ã–µ): ${abcCounts.A} –ø–æ–∑–∏—Ü–∏–π (${((abcCounts.A / data.length) * 100).toFixed(1)}%)</li>
                <li>B (—Å—Ä–µ–¥–Ω–µ–æ–±–æ—Ä–æ—Ç–Ω—ã–µ): ${abcCounts.B} –ø–æ–∑–∏—Ü–∏–π (${((abcCounts.B / data.length) * 100).toFixed(1)}%)</li>
                <li>C (–Ω–∏–∑–∫–æ–æ–±–æ—Ä–æ—Ç–Ω—ã–µ): ${abcCounts.C} –ø–æ–∑–∏—Ü–∏–π (${((abcCounts.C / data.length) * 100).toFixed(1)}%)</li>
            </ul>
            
            <h4>–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º XYZ:</h4>
            <ul>
                <li>X (—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ): ${xyzCounts.X} –ø–æ–∑–∏—Ü–∏–π (${((xyzCounts.X / data.length) * 100).toFixed(1)}%)</li>
                <li>Y (—Å–µ–∑–æ–Ω–Ω—ã–µ): ${xyzCounts.Y} –ø–æ–∑–∏—Ü–∏–π (${((xyzCounts.Y / data.length) * 100).toFixed(1)}%)</li>
                <li>Z (–Ω–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ): ${xyzCounts.Z} –ø–æ–∑–∏—Ü–∏–π (${((xyzCounts.Z / data.length) * 100).toFixed(1)}%)</li>
            </ul>
            
            <h4>–°–∞–º—ã–µ –≤—ã—Å–æ–∫–æ—Ö–æ–¥–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:</h4>
            <div class="product-list">
                ${topProducts.map(product => `<div class="product-item">${product}</div>`).join('')}
            </div>
            
            <h4>–°–∞–º—ã–µ –Ω–∏–∑–∫–æ—Ö–æ–¥–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã:</h4>
            <div class="product-list">
                ${bottomProducts.map(product => `<div class="product-item">${product}</div>`).join('')}
            </div>
        `;
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
    function createCharts(data) {
        // –ü—Ä–æ—Å—Ç—ã–µ HTML/CSS –≥—Ä–∞—Ñ–∏–∫–∏
        createSimpleChart(abcChart, data, 'ABC', ['A', 'B', 'C']);
        createSimpleChart(xyzChart, data, 'XYZ', ['X', 'Y', 'Z']);
    }
    
    function createSimpleChart(container, data, category, categories) {
        const counts = {};
        categories.forEach(cat => counts[cat] = 0);
        
        data.forEach(item => {
            if (counts.hasOwnProperty(item[category])) {
                counts[item[category]]++;
            }
        });
        
        const total = Object.values(counts).reduce((a, b) => a + b, 0);
        
        let chartHTML = '<div class="simple-chart">';
        
        categories.forEach(cat => {
            const percentage = total > 0 ? (counts[cat] / total) * 100 : 0;
            chartHTML += `
                <div class="chart-row">
                    <div class="chart-label">${cat}</div>
                    <div class="chart-bar-container">
                        <div class="chart-bar" style="width: ${percentage}%; background-color: ${getCategoryColor(cat)}"></div>
                    </div>
                    <div class="chart-value">${counts[cat]} (${percentage.toFixed(1)}%)</div>
                </div>
            `;
        });
        
        chartHTML += '</div>';
        container.innerHTML = chartHTML;
    }
    
    function getCategoryColor(category) {
        const colors = {
            'A': '#42e73c',
            'B': '#f39c12',
            'C': '#f53b35',
            'X': '#3498db',
            'Y': '#9b59b6',
            'Z': '#e74c3c'
        };
        return colors[category] || '#95a5a6';
    }
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
    function showNotification(message, type = 'info') {
        notificationText.textContent = message;
        notification.className = `notification ${type}`;
        notification.style.display = 'block';
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
        if (type !== 'error') {
            setTimeout(() => {
                hideNotification();
            }, 5000);
        }
    }
    
    function hideNotification() {
        notification.style.display = 'none';
    }
    
    function updateProgress(percentage) {
        progressFill.style.width = `${percentage}%`;
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–∞–Ω–µ–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    function toggleInfoPanel() {
        const infoPanel = document.getElementById('infoPanel');
        const toggleBtn = document.querySelector('.info-toggle-btn');
        
        infoPanel.classList.toggle('active');
        
        if (infoPanel.classList.contains('active')) {
            toggleBtn.innerHTML = '<span class="btn-icon">‚úï</span><span class="btn-text">–ó–∞–∫—Ä—ã—Ç—å</span>';
        } else {
            toggleBtn.innerHTML = '<span class="btn-icon"></span><span class="btn-text">–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</span>';
        }
    }
    
    // –û–¢–î–ï–õ–¨–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –î–õ–Ø –ü–ê–ù–ï–õ–ò –ò–ù–§–û–†–ú–ê–¶–ò–ò
    document.addEventListener('click', function(event) {
        const infoPanel = document.getElementById('infoPanel');
        const infoToggleBtn = document.querySelector('.info-toggle-btn');
        const chatWindow = document.getElementById('chatWindow');
        const chatBtn = document.querySelector('.chat-bot-btn');
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
        // 1. –û–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞
        // 2. –ö–ª–∏–∫ –Ω–µ –ø–æ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        // 3. –ö–ª–∏–∫ –Ω–µ –ø–æ –∫–Ω–æ–ø–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        // 4. –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –ø–æ —á–∞—Ç-–±–æ—Ç—É –∏ –µ–≥–æ –æ–∫–Ω—É
        if (infoPanel.classList.contains('active') && 
            !infoPanel.contains(event.target) && 
            !infoToggleBtn.contains(event.target) &&
            !chatWindow.contains(event.target) &&
            !chatBtn.contains(event.target)) {
            toggleInfoPanel();
        }
    });

    // –¢–∞–±—ã
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const tabId = tab.getAttribute('data-tab');
            document.getElementById(tabId).classList.add('active');
        });
    });
    
    document.querySelectorAll('.table-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.table-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
        });
    });
</script>

<script>
    // =============================================
    // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ß–ê–¢-–ë–û–¢–ê
    // =============================================

    // –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –±–æ—Ç–∞ - –≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã
    const botKnowledgeBase = {
        // –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ABC –∞–Ω–∞–ª–∏–∑
        'abc –∞–Ω–∞–ª–∏–∑': {
            responses: [
                "ABC –∞–Ω–∞–ª–∏–∑ ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ –∏—Ö –≤–∞–∂–Ω–æ—Å—Ç–∏. –ö–∞—Ç–µ–≥–æ—Ä–∏—è A (55% —Ç–æ–≤–∞—Ä–æ–≤, 80% –æ–±–æ—Ä–æ—Ç–∞), B (30% —Ç–æ–≤–∞—Ä–æ–≤, 15% –æ–±–æ—Ä–æ—Ç–∞), C (15% —Ç–æ–≤–∞—Ä–æ–≤, 5% –æ–±–æ—Ä–æ—Ç–∞).",
                "ABC –∞–Ω–∞–ª–∏–∑ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–¥–µ–ª–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–∫–ª–∞–¥—Å–∫–∏—Ö –∑–∞–ø–∞—Å–æ–≤ –∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏.",
                "–î–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è ABC –∞–Ω–∞–ª–∏–∑–∞ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ: –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, –≤—ã—Ä—É—á–∫–∞ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–∂ –∑–∞ –ø–µ—Ä–∏–æ–¥."
            ],
            keywords: ['abc', '–∞–Ω–∞–ª–∏–∑ abc', '–∫–∞—Ç–µ–≥–æ—Ä–∏–∏', '–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è']
        },
        
        // –ö–∞—Ç–µ–≥–æ—Ä–∏—è: XYZ –∞–Ω–∞–ª–∏–∑
        'xyz –∞–Ω–∞–ª–∏–∑': {
            responses: [
                "XYZ –∞–Ω–∞–ª–∏–∑ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–ø—Ä–æ—Å–∞. X ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Å–ø—Ä–æ—Å, Y ‚Äî —Å–µ–∑–æ–Ω–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è, Z ‚Äî –Ω–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–ø—Ä–æ—Å.",
                "–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ABC-XYZ –∞–Ω–∞–ª–∏–∑ –¥–∞–µ—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É: –≤–∞–∂–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ + –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —Å–ø—Ä–æ—Å–∞.",
                "XYZ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É –≤–∞—Ä–∏–∞—Ü–∏–∏ –ø—Ä–æ–¥–∞–∂."
            ],
            keywords: ['xyz', '–∞–Ω–∞–ª–∏–∑ xyz', '—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å', '—Å–ø—Ä–æ—Å', '–≤–∞—Ä–∏–∞—Ü–∏—è']
        },
        
        // –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –õ–æ–≥–∏—Å—Ç–∏–∫–∞
        '–ª–æ–≥–∏—Å—Ç–∏–∫–∞': {
            responses: [
                "–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ –∑–æ–ª–æ—Ç–æ–π –∑–æ–Ω–µ (0.8-1.6 –º –æ—Ç –ø–æ–ª–∞), —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å 30-40 –¥–Ω–µ–π, –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è.",
                "–ö–∞—Ç–µ–≥–æ—Ä–∏—è B: —Å—Ä–µ–¥–Ω—è—è –∑–æ–Ω–∞ —Å–∫–ª–∞–¥–∞, –∑–∞–ø–∞—Å 15-20 –¥–Ω–µ–π, –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–∑ –≤ 2 –Ω–µ–¥–µ–ª–∏.",
                "–ö–∞—Ç–µ–≥–æ—Ä–∏—è C: —É–¥–∞–ª–µ–Ω–Ω–∞—è –∑–æ–Ω–∞, –º–∏–Ω–∏–º—É–º –∑–∞–ø–∞—Å–∞ (7-10 –¥–Ω–µ–π) –∏–ª–∏ —Ä–∞–±–æ—Ç–∞ –ø–æ–¥ –∑–∞–∫–∞–∑, –µ–∂–µ–º–µ—Å—è—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞."
            ],
            keywords: ['–ª–æ–≥–∏—Å—Ç–∏–∫–∞', '—Å–∫–ª–∞–¥', '—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ', '–∑–∞–ø–∞—Å', '–∑–æ–Ω–∞']
        },
        
        // –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
        '–ø—Ä–∏–≤–µ—Ç': {
            responses: [
                "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫. –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ ABC/XYZ –∞–Ω–∞–ª–∏–∑—É, –ª–æ–≥–∏—Å—Ç–∏–∫–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.",
                "–ü—Ä–∏–≤–µ—Ç! –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –∞–Ω–∞–ª–∏–∑–æ–º —Ç–æ–≤–∞—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ —Å–∫–ª–∞–¥—Å–∫–æ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏—é."
            ],
            keywords: ['–ø—Ä–∏–≤–µ—Ç', '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π', '–¥–æ–±—Ä—ã–π –¥–µ–Ω—å', '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ', 'hello', 'hi']
        },
        
        // –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü–æ–º–æ—â—å
        '–ø–æ–º–æ—â—å': {
            responses: [
                "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å: 1) ABC –∞–Ω–∞–ª–∏–∑–æ–º 2) XYZ –∞–Ω–∞–ª–∏–∑–æ–º 3) –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ 4) –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤",
                "–ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ: –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤, —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–∞ —Å–∫–ª–∞–¥–µ, —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –∑–∞–ø–∞—Å—ã, –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏."
            ],
            keywords: ['–ø–æ–º–æ—â—å', 'help', '—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å', '–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏', '—Ñ—É–Ω–∫—Ü–∏–∏']
        },
        
        // –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –§–∞–π–ª—ã
        '—Ñ–∞–π–ª': {
            responses: [
                "–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å–æ —Å—Ç–æ–ª–±—Ü–∞–º–∏: '–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞', '–í—ã—Ä—É—á–∫–∞ (–£.–ï.)' –∏ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º.",
                "–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: .xlsx –∏–ª–∏ .csv. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏."
            ],
            keywords: ['—Ñ–∞–π–ª', 'excel', '–∑–∞–≥—Ä—É–∑–∏—Ç—å', '—Ñ–æ—Ä–º–∞—Ç', '–¥–∞–Ω–Ω—ã–µ', '–≤—ã—Ä—É—á–∫–∞']
        }
    };

    // –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞
    let chatHistory = [];

    // =============================================
    // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ß–ê–¢-–ë–û–¢–ê
    // =============================================

    /**
     * –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –æ–∫–Ω–∞ —á–∞—Ç–∞
     */
    function toggleChat() {
        const chatWindow = document.getElementById('chatWindow');
        const isOpening = !chatWindow.classList.contains('active');
        
        chatWindow.classList.toggle('active');
        
        // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —á–∞—Ç - —Ñ–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
        if (isOpening) {
            setTimeout(() => {
                document.getElementById('chatInput').focus();
            }, 300);
        }
    }

    /**
     * –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
     */
    function sendMessage() {
        const input = document.getElementById('chatInput');
        const userMessage = input.value.trim();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        if (!userMessage) return;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        addMessageToChat(userMessage, 'user');
        
        // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
        input.value = '';
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        chatHistory.push({
            text: userMessage,
            sender: 'user',
            timestamp: new Date()
        });
        
        // –ò–º–∏—Ç–∞—Ü–∏—è "–ø–µ—á–∞—Ç–∞–µ—Ç..." –Ω–∞ 1 —Å–µ–∫—É–Ω–¥—É
        showTypingIndicator();
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ 1-2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            hideTypingIndicator();
            const botResponse = generateBotResponse(userMessage);
            addMessageToChat(botResponse, 'bot');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç –±–æ—Ç–∞ –≤ –∏—Å—Ç–æ—Ä–∏—é
            chatHistory.push({
                text: botResponse,
                sender: 'bot',
                timestamp: new Date()
            });
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            scrollToBottom();
        }, 1000 + Math.random() * 1000);
    }

    /**
     * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
     */
    function generateBotResponse(userMessage) {
        const message = userMessage.toLowerCase();
        
        // –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
        for (const [category, data] of Object.entries(botKnowledgeBase)) {
            for (const keyword of data.keywords) {
                if (message.includes(keyword)) {
                    const responses = data.responses;
                    return responses[Math.floor(Math.random() * responses.length)];
                }
            }
        }
        
        // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
        const defaultResponses = [
            "–ü–æ–Ω—è–ª –≤–∞—à –≤–æ–ø—Ä–æ—Å. –ú–æ–≥—É —É—Ç–æ—á–Ω–∏—Ç—å: –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –ª–∏ –≤–∞—Å ABC –∞–Ω–∞–ª–∏–∑, XYZ –∞–Ω–∞–ª–∏–∑ –∏–ª–∏ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏?",
            "–î–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ —É—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à –≤–æ–ø—Ä–æ—Å. –ù–∞–ø—Ä–∏–º–µ—Ä: '–ö–∞–∫ –ø—Ä–æ–≤–µ—Å—Ç–∏ ABC –∞–Ω–∞–ª–∏–∑?' –∏–ª–∏ '–ö–∞–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A?'",
            "–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Excel –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –ù—É–∂–Ω—ã —Å—Ç–æ–ª–±—Ü—ã: –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏ –≤—ã—Ä—É—á–∫–∞.",
            "–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞–∑–¥–µ–ª —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –ª–æ–≥–∏—Å—Ç–∏–∫–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤."
        ];
        
        return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
    }

    /**
     * –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
     */
    function addMessageToChat(text, sender) {
        const messagesContainer = document.getElementById('chatMessages');
        const messageDiv = document.createElement('div');
        
        messageDiv.className = `message ${sender}-message`;
        messageDiv.innerHTML = `
            <div class="message-content">${escapeHtml(text)}</div>
            <div class="message-time">${getCurrentTime()}</div>
        `;
        
        messagesContainer.appendChild(messageDiv);
        scrollToBottom();
    }

    /**
     * –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ë–æ—Ç –ø–µ—á–∞—Ç–∞–µ—Ç..."
     */
    function showTypingIndicator() {
        const messagesContainer = document.getElementById('chatMessages');
        const typingDiv = document.createElement('div');
        typingDiv.id = 'typingIndicator';
        typingDiv.className = 'message bot-message typing-indicator';
        typingDiv.innerHTML = `
            <div class="typing-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        `;
        
        messagesContainer.appendChild(typingDiv);
        scrollToBottom();
    }

    /**
     * –°–∫—Ä—ã—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
     */
    function hideTypingIndicator() {
        const typingIndicator = document.getElementById('typingIndicator');
        if (typingIndicator) {
            typingIndicator.remove();
        }
    }

    /**
     * –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —á–∞—Ç–∞ –∫ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏
     */
    function scrollToBottom() {
        const messagesContainer = document.getElementById('chatMessages');
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM
     */
    function getCurrentTime() {
        const now = new Date();
        return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
    }

    /**
     * –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
     */
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    /**
     * –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
     */
    function handleKeyPress(event) {
        if (event.key === 'Enter' && !event.shiftKey) {
            event.preventDefault();
            sendMessage();
        }
    }

    /**
     * –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è —á–∞—Ç–∞
     */
    function addQuickReply(text) {
        const input = document.getElementById('chatInput');
        input.value = text;
        input.focus();
    }

    /**
     * –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
     */
    function clearChatHistory() {
        const messagesContainer = document.getElementById('chatMessages');
        // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        const welcomeMessage = messagesContainer.querySelector('.welcome-message');
        messagesContainer.innerHTML = '';
        messagesContainer.appendChild(welcomeMessage);
        
        // –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
        chatHistory = [];
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—á–∏—Å—Ç–∫–µ
        addMessageToChat('–ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –æ—á–∏—â–µ–Ω–∞. –ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å?', 'bot');
    }

    // =============================================
    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô –ß–ê–¢-–ë–û–¢–ê
    // =============================================

    document.addEventListener('DOMContentLoaded', function() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        initializeChat();
        
        // –û–¢–î–ï–õ–¨–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –î–õ–Ø –ß–ê–¢-–ë–û–¢–ê
        document.addEventListener('click', function(event) {
            const chatWindow = document.getElementById('chatWindow');
            const chatBtn = document.querySelector('.chat-bot-btn');
            const infoPanel = document.getElementById('infoPanel');
            const infoToggleBtn = document.querySelector('.info-toggle-btn');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º —á–∞—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
            // 1. –û–Ω –æ—Ç–∫—Ä—ã—Ç
            // 2. –ö–ª–∏–∫ –Ω–µ –ø–æ –æ–∫–Ω—É —á–∞—Ç–∞
            // 3. –ö–ª–∏–∫ –Ω–µ –ø–æ –∫–Ω–æ–ø–∫–µ —á–∞—Ç–∞
            // 4. –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –ø–æ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –µ–µ –∫–Ω–æ–ø–∫–µ
            if (chatWindow.classList.contains('active') && 
                !chatWindow.contains(event.target) && 
                !chatBtn.contains(event.target) &&
                !infoPanel.contains(event.target) &&
                !infoToggleBtn.contains(event.target)) {
                toggleChat();
            }
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Ç–∞ –ø–æ Escape
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const chatWindow = document.getElementById('chatWindow');
                if (chatWindow.classList.contains('active')) {
                    toggleChat();
                }
            }
        });
    });

    /**
     * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
     */
    function initializeChat() {
        // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
        const messagesContainer = document.getElementById('chatMessages');
        messagesContainer.innerHTML = `
            <div class="welcome-message">
                <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ú–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å –ª—é–±–æ–π –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –í–∞—Å –≤–æ–ø—Ä–æ—Å –ø–æ –∞–Ω–∞–ª–∏–∑—É –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –í–∞–º –ø–æ–º–æ—á—å!</p>
            </div>
        `;
    }

    // =============================================
    // –≠–ö–°–ü–û–†–¢ –§–£–ù–ö–¶–ò–ô –î–õ–Ø –ì–õ–û–ë–ê–õ–¨–ù–û–ì–û –î–û–°–¢–£–ü–ê
    // =============================================
    window.toggleChat = toggleChat;
    window.sendMessage = sendMessage;
    window.handleKeyPress = handleKeyPress;
    window.clearChatHistory = clearChatHistory;
    window.addQuickReply = addQuickReply;
</script>
</body>
</html>